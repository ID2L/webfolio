import{l as K,i as E,t as f,c as k,h as N,z as U,g as z,x as A,A as H,d as O,aX as j,aY as I,r as y,J as h,U as L,O as a,K as S,L as u,f as i,aK as V,u as c,R as m,V as x,P as F,M as Q,S as C}from"./index.f8cb58b3.js";import{A as M,u as J,_ as P,s as $}from"./plugin-vue_export-helper.3c48c7fc.js";import{b as X,d as Y,R as b,m as G,e as W,s as Z,a as ee,c as te,_ as ae}from"./saveExperienceMarkdownFile.34bc6d0e.js";import"./utils.e9ae0538.js";const ne=d=>new M(async l=>{console.log("Into updateDescription with parameters",l);const{data:p,error:n}=await d.rpc("upsert_description",{query_experience_slug:l.experience_slug,language_tag:l.lang,new_content:l.content});if(n)throw n;return!0});var oe=K({name:"QPage",props:{padding:Boolean,styleFn:Function},setup(d,{slots:l}){const{proxy:{$q:p}}=z(),n=E(A,f);if(n===f)return console.error("QPage needs to be a deep child of QLayout"),f;if(E(H,f)===f)return console.error("QPage needs to be child of QPageContainer"),f;const v=k(()=>{const s=(n.header.space===!0?n.header.size:0)+(n.footer.space===!0?n.footer.size:0);if(typeof d.styleFn=="function"){const _=n.isContainer.value===!0?n.containerHeight.value:p.screen.height;return d.styleFn(s,_)}return{minHeight:n.isContainer.value===!0?n.containerHeight.value-s+"px":p.screen.height===0?s!==0?`calc(100vh - ${s}px)`:"100vh":p.screen.height-s+"px"}}),t=k(()=>`q-page${d.padding===!0?" q-layout-padding":""}`);return()=>N("main",{class:t.value,style:v.value},U(l.default))}});const ie={key:0,class:"flex column content-center justify-center item-center q-pa-xl tw-gap-16"},le={class:"tw-maxw-[700px] tw-w-[60vw] tw-text-lg"},se={key:0,class:"tw-maxw-[700px] tw-w-[60vw]"},re={class:"short-description"},ue={class:"tw-maxw-[700px] tw-w-[60vw]"},ce={class:"tw-w-[700px]"},de={class:"tw-max-w-[900px]! tw-w-[900px]"},pe={class:"tw-w-[700px]"},me=O({__name:"ExperiencePage",setup(d){const l=J(),p=j(),n=I(),{data:D,refetch:v}=X(),t=k(()=>{var r;return(r=D.value)==null?void 0:r.find(e=>{const o=p.path.split("experience/")[1];return e.slug===o})}),s=y(!1),_=async r=>{t.value!==void 0&&(s.value=!1,await ee($).call({experience_slug:t.value.slug,content:r,lang:"fr"}),v())},w=y(!1),B=async r=>{t.value!==void 0&&(w.value=!1,await te($).call({experience_slug:t.value.slug,content:r,lang:"fr"}),v())},g=y(!1),R=async r=>{t.value!==void 0&&(g.value=!1,await ne($).call({experience_slug:t.value.slug,content:r,lang:"fr"}),await v())},T=Y(),q=async r=>{T.dialog({component:ae,componentProps:{experience_slug:r}}).onOk(async()=>{await v(),n.push("/experience")})};return(r,e)=>(h(),L(oe,null,{default:a(()=>[t.value?(h(),S("div",ie,[u("div",le,[i(b,{position:"outside-top-right",position2:"outside-top-left"},V({foreground:a(()=>[u("h1",null,F(t.value.title),1)]),_:2},[c(l).editable?{name:"overlay",fn:a(()=>[i(m,{class:"tw-maxw-[200px] tw-mx-4 tw-w-[15vw]",onClick:e[0]||(e[0]=o=>s.value=!0),color:"warning"},{default:a(()=>[x(" Edit Title ")]),_:1})]),key:"0"}:void 0,c(l).editable?{name:"overlay2",fn:a(()=>[i(m,{class:"tw-maxw-[200px] tw-mx-4 tw-w-[15vw]",onClick:e[1]||(e[1]=o=>q(t.value.slug)),color:"negative"},{default:a(()=>[x(" Delete Experience ")]),_:1})]),key:"1"}:void 0]),1024)]),c(l).editable?(h(),S("div",se,[i(b,{position:"outside-top-right"},V({foreground:a(()=>[u("p",re,F(t.value.short_description),1)]),_:2},[c(l).editable?{name:"overlay",fn:a(()=>[i(m,{class:"tw-maxw-[200px] tw-mx-4 tw-w-[15vw]",onClick:e[2]||(e[2]=o=>w.value=!0),color:"warning"},{default:a(()=>[x(" Edit Short Description ")]),_:1})]),key:"0"}:void 0]),1024)])):Q("",!0),u("div",ue,[i(b,{position:"outside-top-right"},V({foreground:a(()=>[i(c(G),{mode:"custom",content:t.value.description},null,8,["content"])]),_:2},[c(l).editable?{name:"overlay",fn:a(()=>[i(m,{class:"tw-maxw-[200px] tw-mx-4 tw-w-[15vw]",onClick:e[3]||(e[3]=o=>g.value=!0),color:"warning"},{default:a(()=>[x(" Edit Description ")]),_:1})]),key:"0"}:void 0]),1024)]),i(C,{modelValue:s.value,"onUpdate:modelValue":e[5]||(e[5]=o=>s.value=o)},{default:a(()=>[u("div",ce,[i(P,{initial_content:t.value.title,field_label:"Title",onFormValidated:_,onCancel:e[4]||(e[4]=o=>s.value=!1)},null,8,["initial_content"])])]),_:1},8,["modelValue"]),i(C,{modelValue:g.value,"onUpdate:modelValue":e[7]||(e[7]=o=>g.value=o),"full-width":""},{default:a(()=>[u("div",de,[i(W,{initial_content:t.value.description,field_label:"Description",file_upload:c(Z)(t.value.slug),onFormValidated:R,onCancel:e[6]||(e[6]=o=>g.value=!1)},null,8,["initial_content","file_upload"])])]),_:1},8,["modelValue"]),i(C,{modelValue:w.value,"onUpdate:modelValue":e[9]||(e[9]=o=>w.value=o)},{default:a(()=>[u("div",pe,[i(P,{initial_content:t.value.short_description,"input-props":{type:"textarea"},field_label:"Short Description",onFormValidated:B,onCancel:e[8]||(e[8]=o=>w.value=!1)},null,8,["initial_content"])])]),_:1},8,["modelValue"])])):Q("",!0)]),_:1}))}});export{me as default};
