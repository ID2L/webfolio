var Y=(t,e,s)=>{if(!e.has(t))throw TypeError("Cannot "+s)};var i=(t,e,s)=>(Y(t,e,"read from private field"),s?s.call(t):e.get(t)),f=(t,e,s)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,s)},l=(t,e,s,r)=>(Y(t,e,"write to private field"),r?r.call(t,s):e.set(t,s),s),W=(t,e,s,r)=>({set _(a){l(t,e,a,s)},get _(){return i(t,e,r)}}),C=(t,e,s)=>(Y(t,e,"access private method"),s);import{r as ye,j as pe}from"./index.f8cb58b3.js";import{S as le,h as ce,Q as ge,n as p,m as Z,R as me,c as Qe,a as ee,b,e as ve,d as Pe,f as Oe,g as we,o as te,r as se,i as De,j as re,p as ie,s as be,k as n,l as Ce,q as Me}from"./utils.e9ae0538.js";var P,ne,fe=(ne=class extends le{constructor(e={}){super();f(this,P,void 0);this.config=e,l(this,P,new Map)}build(e,s,r){var m;const a=s.queryKey,u=(m=s.queryHash)!=null?m:ce(a,s);let o=this.get(u);return o||(o=new ge({cache:this,queryKey:a,queryHash:u,options:e.defaultQueryOptions(s),state:r,defaultOptions:e.getQueryDefaults(a)}),this.add(o)),o}add(e){i(this,P).has(e.queryHash)||(i(this,P).set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const s=i(this,P).get(e.queryHash);s&&(e.destroy(),s===e&&i(this,P).delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){p.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return i(this,P).get(e)}getAll(){return[...i(this,P).values()]}find(e){const s={exact:!0,...e};return this.getAll().find(r=>Z(s,r))}findAll(e={}){const s=this.getAll();return Object.keys(e).length>0?s.filter(r=>Z(e,r)):s}notify(e){p.batch(()=>{this.listeners.forEach(s=>{s(e)})})}onFocus(){p.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){p.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},P=new WeakMap,ne),O,d,K,w,M,ue,qe=(ue=class extends me{constructor(e){super();f(this,w);f(this,O,void 0);f(this,d,void 0);f(this,K,void 0);this.mutationId=e.mutationId,l(this,d,e.mutationCache),l(this,O,[]),this.state=e.state||Ae(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){i(this,O).includes(e)||(i(this,O).push(e),this.clearGcTimeout(),i(this,d).notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){l(this,O,i(this,O).filter(s=>s!==e)),this.scheduleGc(),i(this,d).notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){i(this,O).length||(this.state.status==="pending"?this.scheduleGc():i(this,d).remove(this))}continue(){var e,s;return(s=(e=i(this,K))==null?void 0:e.continue())!=null?s:this.execute(this.state.variables)}async execute(e){var a,u,o,m,S,I,V,z,T,D,j,G,N,B,_,$,y,Q,v,E,J;l(this,K,Qe({fn:()=>this.options.mutationFn?this.options.mutationFn(e):Promise.reject(new Error("No mutationFn found")),onFail:(c,R)=>{C(this,w,M).call(this,{type:"failed",failureCount:c,error:R})},onPause:()=>{C(this,w,M).call(this,{type:"pause"})},onContinue:()=>{C(this,w,M).call(this,{type:"continue"})},retry:(a=this.options.retry)!=null?a:0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>i(this,d).canRun(this)}));const s=this.state.status==="pending",r=!i(this,K).canStart();try{if(!s){C(this,w,M).call(this,{type:"pending",variables:e,isPaused:r}),await((o=(u=i(this,d).config).onMutate)==null?void 0:o.call(u,e,this));const R=await((S=(m=this.options).onMutate)==null?void 0:S.call(m,e));R!==this.state.context&&C(this,w,M).call(this,{type:"pending",context:R,variables:e,isPaused:r})}const c=await i(this,K).start();return await((V=(I=i(this,d).config).onSuccess)==null?void 0:V.call(I,c,e,this.state.context,this)),await((T=(z=this.options).onSuccess)==null?void 0:T.call(z,c,e,this.state.context)),await((j=(D=i(this,d).config).onSettled)==null?void 0:j.call(D,c,null,this.state.variables,this.state.context,this)),await((N=(G=this.options).onSettled)==null?void 0:N.call(G,c,null,e,this.state.context)),C(this,w,M).call(this,{type:"success",data:c}),c}catch(c){try{throw await((_=(B=i(this,d).config).onError)==null?void 0:_.call(B,c,e,this.state.context,this)),await((y=($=this.options).onError)==null?void 0:y.call($,c,e,this.state.context)),await((v=(Q=i(this,d).config).onSettled)==null?void 0:v.call(Q,void 0,c,this.state.variables,this.state.context,this)),await((J=(E=this.options).onSettled)==null?void 0:J.call(E,void 0,c,e,this.state.context)),c}finally{C(this,w,M).call(this,{type:"error",error:c})}}finally{i(this,d).runNext(this)}}},O=new WeakMap,d=new WeakMap,K=new WeakMap,w=new WeakSet,M=function(e){const s=r=>{switch(e.type){case"failed":return{...r,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...r,isPaused:!0};case"continue":return{...r,isPaused:!1};case"pending":return{...r,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...r,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...r,data:void 0,error:e.error,failureCount:r.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}};this.state=s(this.state),p.batch(()=>{i(this,O).forEach(r=>{r.onMutationUpdate(e)}),i(this,d).notify({mutation:this,type:"updated",action:e})})},ue);function Ae(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var g,L,oe,de=(oe=class extends le{constructor(e={}){super();f(this,g,void 0);f(this,L,void 0);this.config=e,l(this,g,new Map),l(this,L,Date.now())}build(e,s,r){const a=new qe({mutationCache:this,mutationId:++W(this,L)._,options:e.defaultMutationOptions(s),state:r});return this.add(a),a}add(e){var a;const s=X(e),r=(a=i(this,g).get(s))!=null?a:[];r.push(e),i(this,g).set(s,r),this.notify({type:"added",mutation:e})}remove(e){var r;const s=X(e);if(i(this,g).has(s)){const a=(r=i(this,g).get(s))==null?void 0:r.filter(u=>u!==e);a&&(a.length===0?i(this,g).delete(s):i(this,g).set(s,a))}this.notify({type:"removed",mutation:e})}canRun(e){var r;const s=(r=i(this,g).get(X(e)))==null?void 0:r.find(a=>a.state.status==="pending");return!s||s===e}runNext(e){var r,a;const s=(r=i(this,g).get(X(e)))==null?void 0:r.find(u=>u!==e&&u.state.isPaused);return(a=s==null?void 0:s.continue())!=null?a:Promise.resolve()}clear(){p.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}getAll(){return[...i(this,g).values()].flat()}find(e){const s={exact:!0,...e};return this.getAll().find(r=>ee(s,r))}findAll(e={}){return this.getAll().filter(s=>ee(e,s))}notify(e){p.batch(()=>{this.listeners.forEach(s=>{s(e)})})}resumePausedMutations(){const e=this.getAll().filter(s=>s.state.isPaused);return p.batch(()=>Promise.all(e.map(s=>s.continue().catch(b))))}},g=new WeakMap,L=new WeakMap,oe);function X(t){var e,s;return(s=(e=t.options.scope)==null?void 0:e.id)!=null?s:String(t.mutationId)}function Fe(t){return{onFetch:(e,s)=>{const r=async()=>{var j,G,N,B,_,$;const a=e.options,u=(N=(G=(j=e.fetchOptions)==null?void 0:j.meta)==null?void 0:G.fetchMore)==null?void 0:N.direction,o=((B=e.state.data)==null?void 0:B.pages)||[],m=((_=e.state.data)==null?void 0:_.pageParams)||[],S={pages:[],pageParams:[]};let I=!1;const V=y=>{Object.defineProperty(y,"signal",{enumerable:!0,get:()=>(e.signal.aborted?I=!0:e.signal.addEventListener("abort",()=>{I=!0}),e.signal)})},z=ve(e.options,e.fetchOptions),T=async(y,Q,v)=>{if(I)return Promise.reject();if(Q==null&&y.pages.length)return Promise.resolve(y);const E={queryKey:e.queryKey,pageParam:Q,direction:v?"backward":"forward",meta:e.options.meta};V(E);const J=await z(E),{maxPages:c}=e.options,R=v?Pe:Oe;return{pages:R(y.pages,J,c),pageParams:R(y.pageParams,Q,c)}};let D;if(u&&o.length){const y=u==="backward",Q=y?Se:ae,v={pages:o,pageParams:m},E=Q(a,v);D=await T(v,E,y)}else{D=await T(S,($=m[0])!=null?$:a.initialPageParam);const y=t!=null?t:o.length;for(let Q=1;Q<y;Q++){const v=ae(a,D);D=await T(D,v)}}return D};e.options.persister?e.fetchFn=()=>{var a,u;return(u=(a=e.options).persister)==null?void 0:u.call(a,r,{queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},s)}:e.fetchFn=r}}}function ae(t,{pages:e,pageParams:s}){const r=e.length-1;return t.getNextPageParam(e[r],e,s[r],s)}function Se(t,{pages:e,pageParams:s}){var r;return(r=t.getPreviousPageParam)==null?void 0:r.call(t,e[0],e,s[0],s)}var h,q,A,x,k,F,H,U,he,Ee=(he=class{constructor(t={}){f(this,h,void 0);f(this,q,void 0);f(this,A,void 0);f(this,x,void 0);f(this,k,void 0);f(this,F,void 0);f(this,H,void 0);f(this,U,void 0);l(this,h,t.queryCache||new fe),l(this,q,t.mutationCache||new de),l(this,A,t.defaultOptions||{}),l(this,x,new Map),l(this,k,new Map),l(this,F,0)}mount(){W(this,F)._++,i(this,F)===1&&(l(this,H,we.subscribe(async t=>{t&&(await this.resumePausedMutations(),i(this,h).onFocus())})),l(this,U,te.subscribe(async t=>{t&&(await this.resumePausedMutations(),i(this,h).onOnline())})))}unmount(){var t,e;W(this,F)._--,i(this,F)===0&&((t=i(this,H))==null||t.call(this),l(this,H,void 0),(e=i(this,U))==null||e.call(this),l(this,U,void 0))}isFetching(t){return i(this,h).findAll({...t,fetchStatus:"fetching"}).length}isMutating(t){return i(this,q).findAll({...t,status:"pending"}).length}getQueryData(t){var s;const e=this.defaultQueryOptions({queryKey:t});return(s=i(this,h).get(e.queryHash))==null?void 0:s.state.data}ensureQueryData(t){const e=this.getQueryData(t.queryKey);if(e===void 0)return this.fetchQuery(t);{const s=this.defaultQueryOptions(t),r=i(this,h).build(this,s);return t.revalidateIfStale&&r.isStaleByTime(se(s.staleTime,r))&&this.prefetchQuery(s),Promise.resolve(e)}}getQueriesData(t){return i(this,h).findAll(t).map(({queryKey:e,state:s})=>{const r=s.data;return[e,r]})}setQueryData(t,e,s){const r=this.defaultQueryOptions({queryKey:t}),a=i(this,h).get(r.queryHash),u=a==null?void 0:a.state.data,o=De(e,u);if(o!==void 0)return i(this,h).build(this,r).setData(o,{...s,manual:!0})}setQueriesData(t,e,s){return p.batch(()=>i(this,h).findAll(t).map(({queryKey:r})=>[r,this.setQueryData(r,e,s)]))}getQueryState(t){var s;const e=this.defaultQueryOptions({queryKey:t});return(s=i(this,h).get(e.queryHash))==null?void 0:s.state}removeQueries(t){const e=i(this,h);p.batch(()=>{e.findAll(t).forEach(s=>{e.remove(s)})})}resetQueries(t,e){const s=i(this,h),r={type:"active",...t};return p.batch(()=>(s.findAll(t).forEach(a=>{a.reset()}),this.refetchQueries(r,e)))}cancelQueries(t={},e={}){const s={revert:!0,...e},r=p.batch(()=>i(this,h).findAll(t).map(a=>a.cancel(s)));return Promise.all(r).then(b).catch(b)}invalidateQueries(t={},e={}){return p.batch(()=>{var r,a;if(i(this,h).findAll(t).forEach(u=>{u.invalidate()}),t.refetchType==="none")return Promise.resolve();const s={...t,type:(a=(r=t.refetchType)!=null?r:t.type)!=null?a:"active"};return this.refetchQueries(s,e)})}refetchQueries(t={},e){var a;const s={...e,cancelRefetch:(a=e==null?void 0:e.cancelRefetch)!=null?a:!0},r=p.batch(()=>i(this,h).findAll(t).filter(u=>!u.isDisabled()).map(u=>{let o=u.fetch(void 0,s);return s.throwOnError||(o=o.catch(b)),u.state.fetchStatus==="paused"?Promise.resolve():o}));return Promise.all(r).then(b)}fetchQuery(t){const e=this.defaultQueryOptions(t);e.retry===void 0&&(e.retry=!1);const s=i(this,h).build(this,e);return s.isStaleByTime(se(e.staleTime,s))?s.fetch(e):Promise.resolve(s.state.data)}prefetchQuery(t){return this.fetchQuery(t).then(b).catch(b)}fetchInfiniteQuery(t){return t.behavior=Fe(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then(b).catch(b)}resumePausedMutations(){return te.isOnline()?i(this,q).resumePausedMutations():Promise.resolve()}getQueryCache(){return i(this,h)}getMutationCache(){return i(this,q)}getDefaultOptions(){return i(this,A)}setDefaultOptions(t){l(this,A,t)}setQueryDefaults(t,e){i(this,x).set(re(t),{queryKey:t,defaultOptions:e})}getQueryDefaults(t){const e=[...i(this,x).values()];let s={};return e.forEach(r=>{ie(t,r.queryKey)&&(s={...s,...r.defaultOptions})}),s}setMutationDefaults(t,e){i(this,k).set(re(t),{mutationKey:t,defaultOptions:e})}getMutationDefaults(t){const e=[...i(this,k).values()];let s={};return e.forEach(r=>{ie(t,r.mutationKey)&&(s={...s,...r.defaultOptions})}),s}defaultQueryOptions(t){if(t._defaulted)return t;const e={...i(this,A).queries,...this.getQueryDefaults(t.queryKey),...t,_defaulted:!0};return e.queryHash||(e.queryHash=ce(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.enabled!==!0&&e.queryFn===be&&(e.enabled=!1),e}defaultMutationOptions(t){return t!=null&&t._defaulted?t:{...i(this,A).mutations,...(t==null?void 0:t.mutationKey)&&this.getMutationDefaults(t.mutationKey),...t,_defaulted:!0}}clear(){i(this,h).clear(),i(this,q).clear()}},h=new WeakMap,q=new WeakMap,A=new WeakMap,x=new WeakMap,k=new WeakMap,F=new WeakMap,H=new WeakMap,U=new WeakMap,he),Re=class extends fe{find(t){return super.find(n(t))}findAll(t={}){return super.findAll(n(t))}},Ke=class extends de{find(t){return super.find(n(t))}findAll(t={}){return super.findAll(n(t))}},Ie=class extends Ee{constructor(t={}){const e={defaultOptions:t.defaultOptions,queryCache:t.queryCache||new Re,mutationCache:t.mutationCache||new Ke};super(e),this.isRestoring=ye(!1)}isFetching(t={}){return super.isFetching(n(t))}isMutating(t={}){return super.isMutating(n(t))}getQueryData(t){return super.getQueryData(n(t))}ensureQueryData(t){return super.ensureQueryData(n(t))}getQueriesData(t){return super.getQueriesData(n(t))}setQueryData(t,e,s={}){return super.setQueryData(n(t),e,n(s))}setQueriesData(t,e,s={}){return super.setQueriesData(n(t),e,n(s))}getQueryState(t){return super.getQueryState(n(t))}removeQueries(t={}){return super.removeQueries(n(t))}resetQueries(t={},e={}){return super.resetQueries(n(t),n(e))}cancelQueries(t={},e={}){return super.cancelQueries(n(t),n(e))}invalidateQueries(t={},e={}){return new Promise(s=>{setTimeout(async()=>{await super.invalidateQueries(n(t),n(e)),s()},0)})}refetchQueries(t={},e={}){return super.refetchQueries(n(t),n(e))}fetchQuery(t){return super.fetchQuery(n(t))}prefetchQuery(t){return super.prefetchQuery(n(t))}fetchInfiniteQuery(t){return super.fetchInfiniteQuery(n(t))}prefetchInfiniteQuery(t){return super.prefetchInfiniteQuery(n(t))}setDefaultOptions(t){super.setDefaultOptions(n(t))}setQueryDefaults(t,e){super.setQueryDefaults(n(t),n(e))}getQueryDefaults(t){return super.getQueryDefaults(n(t))}setMutationDefaults(t,e){super.setMutationDefaults(n(t),n(e))}getMutationDefaults(t){return super.getMutationDefaults(n(t))}},Te={install:(t,e={})=>{const s=Ce(e.queryClientKey);let r;if("queryClient"in e&&e.queryClient)r=e.queryClient;else{const o="queryClientConfig"in e?e.queryClientConfig:void 0;r=new Ie(o)}Me||r.mount();let a=()=>{};if(e.clientPersister){r.isRestoring.value=!0;const[o,m]=e.clientPersister(r);a=o,m.then(()=>{var S;r.isRestoring.value=!1,(S=e.clientPersisterOnSuccess)==null||S.call(e,r)})}const u=()=>{r.unmount(),a()};if(t.onUnmount)t.onUnmount(u);else{const o=t.unmount;t.unmount=function(){u(),o()}}t.provide(s,r)}},Ue=pe(({app:t})=>{t.use(Te)});export{Ue as default};
